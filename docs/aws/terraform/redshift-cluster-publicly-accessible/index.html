<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Redshift Cluster (Publicly Accessible) - Quickhacks</title><link rel="shortcut icon" href="https://albertattard.github.io/quickhacks/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="https://albertattard.github.io/quickhacks/assets/css/quickhacks.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-PE3DWJG4PK"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "G-PE3DWJG4PK"); </script> <script type="text/javascript" src="https://albertattard.github.io/quickhacks/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://albertattard.github.io/quickhacks/assets/js/quickhacks.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Redshift Cluster (Publicly Accessible) | Quickhacks</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="Redshift Cluster (Publicly Accessible)" /><meta property="og:locale" content="en_US" /><meta name="description" content="Quickhacks" /><meta property="og:description" content="Quickhacks" /><link rel="canonical" href="https://albertattard.github.io/quickhacks/docs/aws/terraform/redshift-cluster-publicly-accessible/" /><meta property="og:url" content="https://albertattard.github.io/quickhacks/docs/aws/terraform/redshift-cluster-publicly-accessible/" /><meta property="og:site_name" content="Quickhacks" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Redshift Cluster (Publicly Accessible)" /> <script type="application/ld+json"> {"description":"Quickhacks","@type":"WebPage","headline":"Redshift Cluster (Publicly Accessible)","url":"https://albertattard.github.io/quickhacks/docs/aws/terraform/redshift-cluster-publicly-accessible/","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://albertattard.github.io/quickhacks/" class="site-title lh-tight"> Quickhacks </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item active"><a href="https://albertattard.github.io/quickhacks/docs/aws/" class="navigation-list-link">AWS</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/cli/" class="navigation-list-link">CLI (AWS)</a><li class="navigation-list-item active"> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/" class="navigation-list-link">Terraform (AWS)</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/commands/" class="navigation-list-link">Terraform Commands</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/dynamodb/" class="navigation-list-link">DynamoDB</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/ec2-publicly-accessible/" class="navigation-list-link">EC2 (Publicly Accessible)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/lambda-api-gateway/" class="navigation-list-link">Lambda (API Gateway)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/rds-postgres-publicly-accessible/" class="navigation-list-link">RDS Postgres (Publicly Accessible)</a><li class="navigation-list-item active"> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/redshift-cluster-publicly-accessible/" class="navigation-list-link active">Redshift Cluster (Publicly Accessible)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/aws/terraform/s3-cloud-front/" class="navigation-list-link">S3 & Cloud Front</a></ul></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/azure/" class="navigation-list-link">Azure</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/azure/cli/" class="navigation-list-link">CLI (Azure)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/azure/terraform/" class="navigation-list-link">Terraform (Azure)</a></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/docker/" class="navigation-list-link">Docker</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/docker/cassandra/" class="navigation-list-link">Cassandra</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/docker/jupyter/" class="navigation-list-link">Jupyter</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/docker/postgresql/" class="navigation-list-link">PostgreSQL</a></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/git/" class="navigation-list-link">Git</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/git/change-last-commit-message/" class="navigation-list-link">Change Last Commit Message</a></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/gradle/" class="navigation-list-link">Gradle</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/gradle/gradlew/" class="navigation-list-link">Gradle Wrapper</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/gradle/task-dependencies/" class="navigation-list-link">Task Dependencies</a></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/java/" class="navigation-list-link">Java</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/java/sdkman/" class="navigation-list-link">Setup environment (SDKMAN)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/java/apache-poi/" class="navigation-list-link">Apache POI</a></ul><li class="navigation-list-item"><a href="https://albertattard.github.io/quickhacks/docs/vue/" class="navigation-list-link">Vue</a><ul class="navigation-list-child-list "><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/binding-attributes/" class="navigation-list-link">Binding Attributes (v-bind)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/binding-class/" class="navigation-list-link">Binding Class (v-bind)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/binding-style/" class="navigation-list-link">Binding Style (v-bind)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/components-and-nested-components/" class="navigation-list-link">Components and Nested Components</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/computed-properties/" class="navigation-list-link">Computed Properties</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/create-app/" class="navigation-list-link">Create and Mount Vue Application</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/emit-events/" class="navigation-list-link">Emit Events</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/for-loop/" class="navigation-list-link">For Loop (v-for)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/forms-and-v-model/" class="navigation-list-link">Forms and v-model</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/html/" class="navigation-list-link">HTML (v-html)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/if-else-ladder/" class="navigation-list-link">If-Else Ladder (v-if)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/on-click/" class="navigation-list-link">On Click (v-on:click)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/on-mouseover/" class="navigation-list-link">On Mouseover (v-on:mouseover)</a><li class="navigation-list-item "> <a href="https://albertattard.github.io/quickhacks/docs/vue/show/" class="navigation-list-link">Show (v-show)</a></ul></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000"><a href="https://plugins.gradle.org/search?term=" target="_blank">Gradle Plugins</a></p><p class="text-small text-grey-dk-000"><a href="https://mvnrepository.com/" target="_blank">Maven repository</a></p><p class="text-small text-grey-dk-000"><a href="https://hub.docker.com/search?type=image" target="_blank">Docker Hub</a></p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Quickhacks" aria-label="Search Quickhacks" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg></div><div class="js-search-results search-results-wrap"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="https://github.com/albertattard/quickhacks-source">Quickhacks on GitHub</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://albertattard.github.io/quickhacks/docs/aws/">AWS</a><li class="breadcrumb-nav-list-item"><a href="">Terraform (AWS)</a><li class="breadcrumb-nav-list-item"><span>Redshift Cluster (Publicly Accessible)</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 id="redshift-cluster-publicly-accessible"> <a href="#redshift-cluster-publicly-accessible" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Redshift Cluster (Publicly Accessible)</h1><hr /><h2 id="terraform"> <a href="#terraform" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Terraform</h2><div class="note"> <span class="title">&#9432; Note</span><span class="details">Deployment may take few minute to create all required AWS resources.</span></div><h3 id="file-terraformtf"> <a href="#file-terraformtf" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> File: <code class="highlighter-rouge">terraform.tf</code></h3><p>The bucket <code class="highlighter-rouge">quickhacks-terraform</code> needs to be created beforehand. Refer to <a href="https://albertattard.github.io/quickhacks/docs/aws/cli/s3#create-bucket">create S3 bucket</a> for more information about that.</p><figure class="highlight"><pre><code class="language-terraform" data-lang="terraform"><span class="k">terraform</span> <span class="p">{</span>
  <span class="nx">backend</span> <span class="s2">"s3"</span> <span class="p">{</span>
    <span class="nx">bucket</span> <span class="p">=</span> <span class="s2">"quickhacks-terraform"</span>
    <span class="nx">key</span>    <span class="p">=</span> <span class="s2">"aws/redshift-cluster-publicly-accessible/terraform.tfstate"</span>
    <span class="nx">region</span> <span class="p">=</span> <span class="s2">"eu-central-1"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure><h3 id="file-providerstf"> <a href="#file-providerstf" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> File: <code class="highlighter-rouge">providers.tf</code></h3><figure class="highlight"><pre><code class="language-terraform" data-lang="terraform"><span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
  <span class="c1">// I was getting errors and had to switch to the region where the bucket is</span>
  <span class="c1">//  region = "eu-central-1"</span>
  <span class="nx">region</span> <span class="p">=</span> <span class="s2">"us-west-2"</span>
<span class="p">}</span></code></pre></figure><h3 id="file-maintf"> <a href="#file-maintf" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> File: <code class="highlighter-rouge">main.tf</code></h3><figure class="highlight"><pre><code class="language-terraform" data-lang="terraform"><span class="k">data</span> <span class="s2">"aws_vpc"</span> <span class="s2">"default"</span> <span class="p">{</span>
  <span class="nx">default</span> <span class="p">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="k">data</span> <span class="s2">"aws_subnet_ids"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">default</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_iam_role"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="p">=</span> <span class="s2">"redshift_airflow_role"</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Allows Redshift clusters to call AWS services"</span>

  <span class="nx">assume_role_policy</span> <span class="p">=</span> <span class="nx">jsonencode</span><span class="p">({</span>
    <span class="nx">Version</span> <span class="p">=</span> <span class="s2">"2012-10-17"</span>
    <span class="nx">Statement</span> <span class="p">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">Action</span> <span class="p">=</span> <span class="s2">"sts:AssumeRole"</span>
        <span class="nx">Effect</span> <span class="p">=</span> <span class="s2">"Allow"</span>
        <span class="nx">Principal</span> <span class="p">=</span> <span class="p">{</span>
          <span class="nx">Service</span> <span class="p">=</span> <span class="s2">"redshift.amazonaws.com"</span>
        <span class="p">}</span>
      <span class="p">},</span>
    <span class="p">]</span>
  <span class="p">})</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span>      <span class="p">=</span> <span class="s2">"Redshift Airflow Role"</span>
    <span class="nx">Quickhack</span> <span class="p">=</span> <span class="s2">"Redshift Cluster - Publicly Accessible"</span>
    <span class="nx">ManagedBy</span> <span class="p">=</span> <span class="s2">"Terraform"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_iam_role_policy_attachment"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">role</span>       <span class="p">=</span> <span class="nx">aws_iam_role</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">name</span>
  <span class="nx">policy_arn</span> <span class="p">=</span> <span class="s2">"arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess"</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="p">=</span> <span class="s2">"redshift_security_group"</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Authorise redshift cluster access"</span>
  <span class="nx">vpc_id</span>      <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">default</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Allow access to Redshift from anywhere in the world!!"</span>
    <span class="nx">from_port</span>   <span class="p">=</span> <span class="mi">5439</span>
    <span class="nx">to_port</span>     <span class="p">=</span> <span class="mi">5439</span>
    <span class="nx">protocol</span>    <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">egress</span> <span class="p">{</span>
    <span class="nx">from_port</span>   <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">to_port</span>     <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">protocol</span>    <span class="p">=</span> <span class="s2">"-1"</span>
    <span class="nx">cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span>      <span class="p">=</span> <span class="s2">"Redshift Security Group"</span>
    <span class="nx">Quickhack</span> <span class="p">=</span> <span class="s2">"Redshift Cluster - Publicly Accessible"</span>
    <span class="nx">ManagedBy</span> <span class="p">=</span> <span class="s2">"Terraform"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"random_password"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">length</span>           <span class="p">=</span> <span class="mi">16</span>
  <span class="nx">special</span>          <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">override_special</span> <span class="p">=</span> <span class="s2">"!#</span><span class="err">$</span><span class="s2">&amp;-_+."</span>
  <span class="nx">min_lower</span>        <span class="p">=</span> <span class="mi">1</span>
  <span class="nx">min_upper</span>        <span class="p">=</span> <span class="mi">1</span>
  <span class="nx">min_numeric</span>      <span class="p">=</span> <span class="mi">1</span>
  <span class="nx">min_special</span>      <span class="p">=</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_redshift_subnet_group"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">name</span>       <span class="p">=</span> <span class="s2">"redshift-subnet-group"</span>
  <span class="nx">subnet_ids</span> <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">aws_subnet_ids</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">ids</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span>      <span class="p">=</span> <span class="s2">"Redshift Subnet Group"</span>
    <span class="nx">Quickhack</span> <span class="p">=</span> <span class="s2">"Redshift Cluster - Publicly Accessible"</span>
    <span class="nx">ManagedBy</span> <span class="p">=</span> <span class="s2">"Terraform"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_redshift_cluster"</span> <span class="s2">"redshift"</span> <span class="p">{</span>
  <span class="nx">cluster_identifier</span>        <span class="p">=</span> <span class="s2">"quickhack-redshift-cluster"</span>
  <span class="nx">database_name</span>             <span class="p">=</span> <span class="s2">"quickhack_db"</span>
  <span class="nx">port</span>                      <span class="p">=</span> <span class="mi">5439</span>
  <span class="nx">master_username</span>           <span class="p">=</span> <span class="s2">"quickhack"</span>
  <span class="nx">master_password</span>           <span class="p">=</span> <span class="nx">random_password</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">result</span>
  <span class="nx">node_type</span>                 <span class="p">=</span> <span class="s2">"dc2.large"</span>
  <span class="nx">cluster_type</span>              <span class="p">=</span> <span class="s2">"single-node"</span>
  <span class="nx">number_of_nodes</span>           <span class="p">=</span> <span class="mi">1</span>
  <span class="nx">publicly_accessible</span>       <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">cluster_subnet_group_name</span> <span class="p">=</span> <span class="nx">aws_redshift_subnet_group</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">name</span>
  <span class="nx">vpc_security_group_ids</span>    <span class="p">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
  <span class="nx">iam_roles</span>                 <span class="p">=</span> <span class="p">[</span><span class="nx">aws_iam_role</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">arn</span><span class="p">]</span>
  <span class="nx">enhanced_vpc_routing</span>      <span class="p">=</span> <span class="kc">false</span>
  <span class="nx">skip_final_snapshot</span>       <span class="p">=</span> <span class="kc">true</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span>      <span class="p">=</span> <span class="s2">"Redshift Cluster"</span>
    <span class="nx">Quickhack</span> <span class="p">=</span> <span class="s2">"Redshift Cluster - Publicly Accessible"</span>
    <span class="nx">ManagedBy</span> <span class="p">=</span> <span class="s2">"Terraform"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure><h3 id="file-outputtf"> <a href="#file-outputtf" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> File: <code class="highlighter-rouge">output.tf</code></h3><figure class="highlight"><pre><code class="language-terraform" data-lang="terraform"><span class="k">output</span> <span class="s2">"redshift_master_password"</span> <span class="p">{</span>
  <span class="nx">value</span>     <span class="p">=</span> <span class="nx">aws_redshift_cluster</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">master_password</span>
  <span class="nx">sensitive</span> <span class="p">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="k">output</span> <span class="s2">"redshift_dns_name"</span> <span class="p">{</span>
  <span class="nx">value</span> <span class="p">=</span> <span class="nx">aws_redshift_cluster</span><span class="p">.</span><span class="nx">redshift</span><span class="p">.</span><span class="nx">dns_name</span>
<span class="p">}</span></code></pre></figure><h2 id="connect-to-the-database"> <a href="#connect-to-the-database" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Connect to the database</h2><p>PostgreSQL client can be used to connect to Redshift. The following Dockerfile installs <code class="highlighter-rouge">postgresql-client-12</code> on a Ubuntu image and can be used to connect to the Redshift cluster.</p><figure class="highlight"><pre><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span><span class="s"> ubuntu:20.04</span>
<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">-y</span> postgresql-client-12

<span class="k">ENV</span><span class="s"> PGPORT=5439</span>
<span class="k">ENV</span><span class="s"> PGUSER="quickhack"</span>
<span class="k">ENV</span><span class="s"> PGDATABASE="quickhack_db"</span>

<span class="k">ENTRYPOINT</span><span class="s"> ["psql"]</span></code></pre></figure><ol><li><p>Build the docker image</p><div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>docker build <span class="nb">.</span> <span class="nt">-t</span> postgresql-client:local 
</code></pre></div></div><li><p>Connect to the database using the docker container</p><p>The following command needs to be executed from the same directory where the terraform scripts are as it uses the terraform output to connect to set two environment variables required to the database.</p><div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>docker run <span class="se">\</span>
  <span class="nt">-e</span> <span class="nv">PGHOST</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nv">AWS_PROFILE</span><span class="o">=</span><span class="s2">"quickhacks"</span> terraform output <span class="nt">-json</span> | jq <span class="nt">-r</span> <span class="s2">".redshift_dns_name.value"</span><span class="si">)</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-e</span> <span class="nv">PGPASSWORD</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nv">AWS_PROFILE</span><span class="o">=</span><span class="s2">"quickhacks"</span> terraform output <span class="nt">-json</span> | jq <span class="nt">-r</span> <span class="s2">".redshift_master_password.value"</span><span class="si">)</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">-it</span> postgresql-client:local 
</code></pre></div></div><li><p>Type <code class="highlighter-rouge">\q</code> to exit</p></ol><h2 id="versions"> <a href="#versions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Versions</h2><ol><li><p>Terraform</p><div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp"> $</span><span class="w"> </span>terraform <span class="nt">--version</span>
<span class="go"> Terraform v0.15.0
</span></code></pre></div></div></ol><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; Albert Attard. Distributed by an <a href="https://opensource.org/licenses/Apache-2.0">Apache License 2.0.</a></p></footer></div></div></div></div>
